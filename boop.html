<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>6x6 Data-Linked Table</title>
    <style>
      table {
        border-collapse: collapse;
        width: 50%;
      }
      th,
      td {
        border: 1px solid black;
        padding: 8px;
        text-align: center;
      }
      th {
        background-color: #f2f2f2;
      }
    </style>
  </head>
  <body>
    <h1>6x6 Data-Linked Table</h1>
    <table id="data-table">
      <thead>
        <tr>
          <th>Header 1</th>
          <th>Header 2</th>
          <th>Header 3</th>
          <th>Header 4</th>
          <th>Header 5</th>
          <th>Header 6</th>
        </tr>
      </thead>
      <tbody>
        <!-- Table rows will be generated by JavaScript -->
      </tbody>
    </table>
    <input type="number" name="rowNumber" />
    <input type="number" name="colNumber" />
    <button type="button" class="btn" onclick="placeX();">X</button>
    <button type="button" class="btn" onclick="placeO();">O</button>

    <script>
      // Initialize a 6x6 array
      let dataArray = [
        [" ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " "],
      ];

      function generateTable(data) {
        const tableBody = document.querySelector("#data-table tbody");
        tableBody.innerHTML = ""; // Clear existing table rows

        data.forEach((row) => {
          const tr = document.createElement("tr");
          row.forEach((cell) => {
            const td = document.createElement("td");
            td.textContent = cell;
            tr.appendChild(td);
          });
          tableBody.appendChild(tr);
        });
      }

      // Generate table on page load
      document.addEventListener("DOMContentLoaded", () => {
        generateTable(dataArray);
      });

      function placeX() {
        //do nothing for now
      }

      function placeY() {
        //do nothing for now
      }

      function moveAgacents(row, col) {
        // Directions are keypad directions. I'm sure this is stupid and I'll regret it later.
        let edges = checkEdge(row, col); //returns 1 if top edge, 2 if left edge, 4 if right edge, 8 if bottom edge and 0 if not edge
        if (edges == 3) {
          // top left corner
          if (dataArray[row + 1][col] != " ") move(row + 1, col, 2);
          if (dataArray[row + 1][col + 1] != " ") move(row + 1, col + 1, 3);
          if (dataArray[row][col + 1] != " ") move(row, col + 1, 6);
          return;
        }
        if (edges == 5) {
          // top right corner
          if (dataArray[row + 1][col] != " ") move(row + 1, col, 2);
          if (dataArray[row + 1][col - 1] != " ") move(row + 1, col - 1, 1);
          if (dataArray[row][col - 1] != " ") move(row, col - 1, 4);
          return;
        }
        if (edges == 10) {
          // bottom left corner
          if (dataArray[row - 1][col] != " ") move(row - 1, col, 8);
          if (dataArray[row - 1][col + 1] != " ") move(row - 1, col + 1, 9);
          if (dataArray[row][col + 1] != " ") move(row, col + 1, 6);
          return;
        }
        if (edges == 12) {
          // bottom right corner
          if (dataArray[row - 1][col] != " ") move(row - 1, col, 8);
          if (dataArray[row - 1][col - 1] != " ") move(row - 1, col - 1, 7);
          if (dataArray[row][col - 1] != " ") move(row, col - 1, 4);
          return;
        }
        if (edges == 1) {
          // top edge
          if (dataArray[row][col - 1] != " ") move(row, col - 1, 4);
          if (dataArray[row][col + 1] != " ") move(row, col + 1, 6);
          if (dataArray[row + 1][col - 1] != " ") move(row + 1, col - 1, 1);
          if (dataArray[row + 1][col] != " ") move(row + 1, col, 2);
          if (dataArray[row + 1][col + 1] != " ") move(row + 1, col + 1, 3);
          return;
        }
        if (edges == 8) {
          // bottom edge
          if (dataArray[row][col - 1] != " ") move(row, col - 1, 4);
          if (dataArray[row][col + 1] != " ") move(row, col + 1, 6);
          if (dataArray[row - 1][col - 1] != " ") move(row - 1, col - 1, 7);
          if (dataArray[row - 1][col] != " ") move(row - 1, col, 8);
          if (dataArray[row - 1][col + 1] != " ") move(row - 1, col + 1, 9);
          return;
        }
        if (edges == 2) {
          // left edge
          if (dataArray[row - 1][col] != " ") move(row - 1, col, 8);
          if (dataArray[row + 1][col] != " ") move(row + 1, col, 2);
          if (dataArray[row - 1][col + 1] != " ") move(row - 1, col + 1, 9);
          if (dataArray[row][col + 1] != " ") move(row, col + 1, 6);
          if (dataArray[row + 1][col + 1] != " ") move(row + 1, col + 1, 3);
          return;
        }
        if (edges == 4) {
          // right edge
          if (dataArray[row - 1][col] != " ") move(row - 1, col, 8);
          if (dataArray[row + 1][col] != " ") move(row + 1, col, 2);
          if (dataArray[row - 1][col - 1] != " ") move(row - 1, col - 1, 7);
          if (dataArray[row][col - 1] != " ") move(row, col - 1, 4);
          if (dataArray[row + 1][col - 1] != " ") move(row + 1, col - 1, 1);
          return;
        }
        if (dataArray[row - 1][col - 1] != " ") move(row - 1, col - 1, 7);
        if (dataArray[row - 1][col] != " ") move(row - 1, col, 8);
        if (dataArray[row - 1][col + 1] != " ") move(row - 1, col + 1, 9);
        if (dataArray[row][col - 1] != " ") move(row, col - 1, 4);
        if (dataArray[row][col + 1] != " ") move(row, col + 1, 6);
        if (dataArray[row + 1][col - 1] != " ") move(row + 1, col - 1, 1);
        if (dataArray[row + 1][col] != " ") move(row + 1, col, 2);
        if (dataArray[row + 1][col + 1] != " ") move(row + 1, col + 1, 3);
        return;
      }

      function move(row, col, direction) {
        // checks for edges and cats on agacent space in direction of movement and then moves current piece
        let edges = checkEdge(row, col);
        switch (direction) {
          case 1: {
            if (edges == 8 || edges == 2 || edges == 10) {
              dataArray[row][col] = " ";
              break;
            }
            dataArray[row + 1][col - 1] = dataArray[row][col];
            dataArray[row][col] = " ";
            break;
          }
          case 2: {
            if (edges == 8 || edges == 12 || edges == 10) {
              dataArray[row][col] = " ";
              break;
            }
            dataArray[row + 1][col] = dataArray[row][col];
            dataArray[row][col] = " ";
            break;
          }
          case 3: {
            if (edges == 8 || edges == 12 || edges == 4) {
              dataArray[row][col] = " ";
              break;
            }
            dataArray[row + 1][col + 1] = dataArray[row][col];
            dataArray[row][col] = " ";
            break;
          }
          case 4: {
            if (edges == 2 || edges == 3 || edges == 10) {
              dataArray[row][col] = " ";
              break;
            }
            dataArray[row][col - 1] = dataArray[row][col];
            dataArray[row][col] = " ";
            break;
          }
          case 5:
            console.log("wrong direction");
            break;
          case 6: {
            if (edges == 4 || edges == 5 || edges == 12) {
              dataArray[row][col] = " ";
              break;
            }
            dataArray[row][col + 1] = dataArray[row][col];
            dataArray[row][col] = " ";
            break;
          }
          case 7: {
            if (edges == 2 || edges == 1 || edges == 3) {
              dataArray[row][col] = " ";
              break;
            }
            dataArray[row - 1][col - 1] = dataArray[row][col];
            dataArray[row][col] = " ";
            break;
          }
          case 8: {
            if (edges == 5 || edges == 1 || edges == 3) {
              dataArray[row][col] = " ";
              break;
            }
            dataArray[row - 1][col] = dataArray[row][col];
            dataArray[row][col] = " ";
            break;
          }
          case 9: {
            if (edges == 5 || edges == 1 || edges == 4) {
              dataArray[row][col] = " ";
              break;
            }
            dataArray[row - 1][col + 1] = dataArray[row][col];
            dataArray[row][col] = " ";
            break;
          }
        }
      }

      function checkEdge(row, col) {
        //returns 1 if top edge, 2 if left edge, 4 if right edge, 8 if bottom edge and 0 if not edge
        let edges = 0;
        if (row == 0) edges += 1;
        if (row == 5) edges += 8;
        if (col == 0) edges += 2;
        if (col == 5) edges += 4;
        return edges;
      }

      // Function to update dataArray and regenerate the table
      function updateTableCell(row, col, value) {
          if (
              row >= 0 &&
              row < dataArray.length &&
              col >= 0 &&
              col < dataArray[row].length
              ) {
            console.log(dataArray, row, col, value);
          if (dataArray[row][col] == " ") {
            dataArray[row][col] = value;
            moveAgacents(row, col);
            generateTable(dataArray);
          }
        } else {
          console.error("Invalid row or column index");
        }
      }

      updateTableCell(1, 2, "X");
      //generateTable(dataArray);
      // Example of updating a cell (row 2, col 3) and regenerating the table
      // updateTableCell(1, 2, 'Updated');
    </script>
  </body>
</html>
